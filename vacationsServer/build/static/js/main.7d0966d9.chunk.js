(this["webpackJsonpvacations-react"]=this["webpackJsonpvacations-react"]||[]).push([[0],{104:function(e,t,a){},106:function(e,t,a){},143:function(e,t,a){},146:function(e,t,a){},199:function(e,t,a){},200:function(e,t,a){},202:function(e,t,a){},203:function(e,t,a){},206:function(e,t,a){},301:function(e,t,a){},303:function(e,t,a){"use strict";a.r(t);var n=a(0),s=a.n(n),r=a(13),i=a.n(r);a(142),a(143),Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var o,c=a(4),l=a(8),d=a(12),u=a(11),p=a(3),m=a.n(p),h=a(9),v=a(15),f=a(124);!function(e){e[e.SendVacationToUpdate=0]="SendVacationToUpdate",e[e.handleVacationEditModal=1]="handleVacationEditModal",e[e.updateUserLoginStatus=2]="updateUserLoginStatus",e[e.logOutUser=3]="logOutUser",e[e.setUserSocket=4]="setUserSocket",e[e.handleNewVacationModal=5]="handleNewVacationModal",e[e.handleAdminGraphVisibility=6]="handleAdminGraphVisibility"}(o||(o={}));var g=function e(t,a,n,s,r,i,o,l,d){Object(c.a)(this,e),this.id=t,this.description=a,this.destination=n,this.picture=s,this.fromDate=r,this.toDate=i,this.price=o,this.isLiked=l,this.followersAmount=d},b=Object(f.a)((function(e,t){var a=Object(v.a)({},e);switch(t.type){case o.handleVacationEditModal:a.vacationToEdit=t.payload[0],a.isEditModalVisible=t.payload[1];break;case o.handleNewVacationModal:a.vacationToAdd=t.payload[0],a.isNewVacationModalVisible=t.payload[1];break;case o.handleAdminGraphVisibility:a.isAdminGraphVisible=t.payload;break;case o.updateUserLoginStatus:a.userName=t.payload[0],a.isUserLoggedIn=t.payload[1],a.userType=t.payload[2];break;case o.logOutUser:a.isUserLoggedIn=t.payload,a.socket="";break;case o.setUserSocket:a.socket=t.payload}return a}),new function e(){Object(c.a)(this,e),this.vacationToAdd=new g(0,"","",new File([""],""),"","",0,!1,0),this.isNewVacationModalVisible=!1,this.vacationToEdit=void 0,this.isEditModalVisible=!1,this.isAdminGraphVisible=!1,this.isUserLoggedIn=void 0,this.userName="",this.socket="",this.userType=""}),N=(a(146),a(10)),E=a.n(N),V=a(5),k=a(126),w=a.n(k),S=function(e){Object(d.a)(a,e);var t=Object(u.a)(a);function a(){return Object(c.a)(this,a),t.apply(this,arguments)}return a}(n.Component);S.updateReduxStoreOnLogin=function(e,t,a){b.dispatch({type:o.updateUserLoginStatus,payload:[e,t,a]})},S.setUserSocket=function(){var e=w()(window.location.hostname,{query:"token="+sessionStorage.getItem("token")}).connect();return b.dispatch({type:o.setUserSocket,payload:e}),e},S.logOutUser=function(){b.getState().socket.disconnect(),b.dispatch({type:o.logOutUser,payload:!1})},S.handleUnloggedUser=Object(h.a)(m.a.mark((function e(){var t;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!==(t=sessionStorage.getItem("token"))&&"undefined"!==t){e.next=5;break}return e.abrupt("return","exit");case 5:return e.next=7,S.loginWithToken(t);case 7:case"end":return e.stop()}}),e)}))),S.loginWithToken=function(){var e=Object(h.a)(m.a.mark((function e(t){var a,n;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,E.a.defaults.headers.common.authorization="Bearer "+t,e.next=4,E.a.post("https://adar-vacations.herokuapp.com/users/logUserWithToken");case 4:a=e.sent,n=a.data,V.b.success("Welcome Back "+n.userName+"!"),S.updateReduxStoreOnLogin(n.userName,!0,n.userType),S.setUserSocket(),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(0),V.b.error(e.t0.response.data.error);case 14:case"end":return e.stop()}}),e,null,[[0,11]])})));return function(t){return e.apply(this,arguments)}}(),S.saveUserDetailsOnSession=function(e){sessionStorage.setItem("token",e.token),sessionStorage.setItem("userName",e.userName)};var y=function(e){Object(d.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).unsubscribeStore=void 0,n.getHelloMessageContent=function(){Object(v.a)({},n.state).helloMessage;return n.state.isUserLoggedIn?"Hello "+n.state.userName:"Hello guest"},n.logOutUser=Object(h.a)(m.a.mark((function e(){var t;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t=sessionStorage.getItem("token"),E.a.defaults.headers.common.authorization="Bearer "+t,e.next=5,E.a.post("https://adar-vacations.herokuapp.com/users/logOutUser/");case 5:sessionStorage.clear(),S.logOutUser(),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),V.b.error(e.t0.response.data.error);case 12:case"end":return e.stop()}}),e,null,[[0,9]])}))),n.getLogOutButton=function(){return n.state.isUserLoggedIn?s.a.createElement("button",{onClick:n.logOutUser},"Logout"):s.a.createElement("button",{disabled:!0},"Please login")},n.state={isUserLoggedIn:b.getState().isUserLoggedIn,userName:b.getState().userName,helloMessage:"Hello guest"},n}return Object(l.a)(a,[{key:"componentDidMount",value:function(){var e=this;this.unsubscribeStore=b.subscribe((function(){return e.setState({isUserLoggedIn:b.getState().isUserLoggedIn,userName:b.getState().userName})}))}},{key:"componentWillUnmount",value:function(){this.unsubscribeStore()}},{key:"render",value:function(){return s.a.createElement("div",{className:"header"},s.a.createElement("button",{id:"helloMessage",disabled:!0},this.getHelloMessageContent()),s.a.createElement("h1",null,"Adar's Vacations Site"),this.getLogOutButton())}}]),a}(n.Component),D=a(34),O=a(319),x=(a(104),function e(t,a){Object(c.a)(this,e),this.userName=t,this.password=a}),T=function(e){Object(d.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).setUserName=function(e){var t=e.target.value;n.setState({userName:t})},n.setPassword=function(e){var t=e.target.value;n.setState({password:t})},n.login=Object(h.a)(m.a.mark((function e(){var t,a,s;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!1!==n.validateInputs()){e.next=3;break}return V.b.warning("Please fill valid username and password!"),e.abrupt("return");case 3:return e.prev=3,t=new x(n.state.userName,n.state.password),e.next=7,E.a.post("https://adar-vacations.herokuapp.com/users/login",t);case 7:a=e.sent,s=a.data,S.updateReduxStoreOnLogin(n.state.userName,!0,s.userType),S.saveUserDetailsOnSession(s),V.b.success("Welcome Back "+n.state.userName+"!"),"ADMIN"===s.userType?(n.props.history.push("/admin"),sessionStorage.setItem("userType","ADMIN")):(n.props.history.push("/vacationsboard"),sessionStorage.setItem("userType","USER")),S.setUserSocket(),e.next=20;break;case 16:e.prev=16,e.t0=e.catch(3),V.b.error(e.t0.response.data.error),console.log(e.t0.response.data.error);case 20:case"end":return e.stop()}}),e,null,[[3,16]])}))),n.state={userName:"",password:""},n}return Object(l.a)(a,[{key:"componentDidMount",value:function(){var e=Object(h.a)(m.a.mark((function e(){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,S.handleUnloggedUser();case 2:if("exit"===e.sent){e.next=6;break}return this.props.history.push("/vacationsboard"),e.abrupt("return");case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"validateInputs",value:function(){return""!==this.state.userName&&""!==this.state.password&&(!(this.state.userName.length>12||this.state.userName.length<3||this.state.password.length<6||this.state.password.length>12)&&void 0)}},{key:"render",value:function(){return s.a.createElement("div",{className:"entranceDiv"},s.a.createElement("h2",null,"Login"),s.a.createElement("form",{id:"form1",onSubmit:function(e){return e.preventDefault()}},s.a.createElement("table",null,s.a.createElement("tbody",{id:"loginTable"},s.a.createElement("tr",null,s.a.createElement("td",null,"Username:"),s.a.createElement("td",null,s.a.createElement("input",{placeholder:"Username",value:this.state.userName,onChange:this.setUserName,type:"text"}))),s.a.createElement("tr",null,s.a.createElement("td",null,"Password:"),s.a.createElement("td",null,s.a.createElement("input",{placeholder:"Password",autoComplete:"on",type:"password",onChange:this.setPassword,value:this.state.password})))))),s.a.createElement(O.a,{id:"loginButton",type:"submit",form:"form1",className:"button",onClick:this.login},"LOGIN"),s.a.createElement("br",null),s.a.createElement("br",null),"Don't have an account?",s.a.createElement("br",null),s.a.createElement(O.a,{component:D.b,to:"/register",className:"button"},"Register"))}}]),a}(n.Component),A=(a(198),function(){var e=Object(h.a)(m.a.mark((function e(){var t,a,n;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t=sessionStorage.getItem("token"),E.a.defaults.headers.common.authorization="Bearer "+t,e.next=5,E.a.get("https://adar-vacations.herokuapp.com/vacations");case 5:return a=e.sent,n=a.data,e.abrupt("return",n);case 10:return e.prev=10,e.t0=e.catch(0),e.abrupt("return",e.t0);case 13:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(){return e.apply(this,arguments)}}()),C=(a(106),function(e){Object(d.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).unsubscribeStore=void 0,n.componentDidUpdate=function(){b.getState().isUserLoggedIn||n.props.history.push("/"),"ADMIN"===b.getState().userType&&n.props.history.push("/admin")},n.changeHistory=Object(h.a)(m.a.mark((function e(){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n.state.isUserLoggedIn||n.props.history.push("/");case 1:case"end":return e.stop()}}),e)}))),n.setSocketListeners=function(){n.state.socket.on("increase-vacation-likes",(function(e){var t=n.getIndexFromVacations(e),a=n.state.vacations;a[t].followersAmount=a[t].followersAmount+1,n.setState({vacations:a})})),n.state.socket.on("decrease-vacation-likes",(function(e){var t=n.getIndexFromVacations(e),a=n.state.vacations;a[t].followersAmount=a[t].followersAmount-1,n.setState({vacations:a})})),n.state.socket.on("delete-vacation",(function(e){var t=n.getIndexFromVacations(e),a=n.state.vacations;a.splice(t,1),n.setState({vacations:a})})),n.state.socket.on("update-vacation",(function(e){var t=n.state.vacations;t=t.map((function(a){if(a.id===e.id){var s=n.getIndexFromVacations(a.id);return t[s]=e,n.setState({vacations:t}),e}return a}))})),n.state.socket.on("add-vacation",(function(e){e.fromDate=n.changeDateFormat(e.fromDate),e.toDate=n.changeDateFormat(e.toDate);var t=n.state.vacations;t.push(e),n.setState({vacations:t})}))},n.changeDateFormat=function(e){var t=e.split("-");return t[2]+"/"+t[1]+"/"+t[0]},n.getIndexFromVacations=function(e){return n.state.vacations.findIndex((function(t){return t.id===e}))},n.toggleFavorite=function(){var e=Object(h.a)(m.a.mark((function e(t){var a,s,r;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=!t.isLiked,s=n.state.socket,!a){e.next=9;break}return e.next=5,E.a.post("https://adar-vacations.herokuapp.com/vacations/addToFavorites/",{vacationId:t.id});case 5:t.followersAmount=t.followersAmount+1,s.emit("increase-vacation-likes",t.id),e.next=13;break;case 9:return e.next=11,E.a.post("https://adar-vacations.herokuapp.com/vacations/removeFromFavorites/",{vacationId:t.id});case 11:t.followersAmount=t.followersAmount-1,s.emit("decrease-vacation-likes",t.id);case 13:t.isLiked=a,r=Object(v.a)({},n.state),n.setState(r);case 16:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n.order=function(e,t){return e.isLiked>t.isLiked?-1:e.isLiked<t.isLiked?1:0},n.state={vacations:new Array,isUserLoggedIn:b.getState().isUserLoggedIn,socket:b.getState().socket},n}return Object(l.a)(a,[{key:"componentDidMount",value:function(){var e=Object(h.a)(m.a.mark((function e(){var t,a=this;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!0===b.getState().isUserLoggedIn){e.next=7;break}return e.next=3,S.handleUnloggedUser();case 3:if("exit"!==e.sent){e.next=7;break}return this.props.history.push("/"),e.abrupt("return");case 7:return e.next=9,A();case 9:t=e.sent,this.setState({vacations:t}),this.setState({socket:b.getState().socket}),this.unsubscribeStore=b.subscribe((function(){return a.setState({isUserLoggedIn:b.getState().isUserLoggedIn,socket:b.getState().socket},(function(){a.changeHistory()}))})),this.setSocketListeners();case 14:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"componentWillUnmount",value:function(){this.unsubscribeStore()}},{key:"render",value:function(){var e=this;return s.a.createElement("div",{id:"allVacationsBoard",className:"scrollbar scrollbar-morpheus-den"},s.a.createElement("h1",{className:"headers"},"All Vacations"),s.a.createElement("div",{id:"vacationsBoard"},this.state.vacations.sort((function(t,a){return e.order(t,a)})).map((function(t,n){return s.a.createElement("div",{key:n,className:"card"},s.a.createElement("img",{className:"card-img-top",src:t.picture.toString(),alt:"../../UndefinedPictures/defaultPicture.jpg"}),s.a.createElement("div",{className:"card-body"},s.a.createElement("h5",{className:"card-title"},t.destination),s.a.createElement("p",{className:"desc"},t.description),s.a.createElement("p",{className:"card-text"},s.a.createElement("b",null,"From Date: "),t.fromDate),s.a.createElement("p",{className:"card-text"},s.a.createElement("b",null,"To Date: "),t.toDate),s.a.createElement("h5",{className:"card-title"},t.price,"$"),s.a.createElement("div",{className:"favoritesContainer"},s.a.createElement("span",{className:a.getVacationFavoriteClass(t.isLiked),onClick:function(){e.toggleFavorite(t)}},"favorite"),s.a.createElement("span",{className:"followersAmount",id:JSON.stringify(t.id)},t.followersAmount," Liked it"))))}))))}}]),a}(n.Component));C.getVacationFavoriteClass=function(e){return e?"material-icons liked":"material-icons"};var U=a(16),j=(a(199),function(e){Object(d.a)(a,e);var t=Object(u.a)(a);function a(){return Object(c.a)(this,a),t.apply(this,arguments)}return Object(l.a)(a,[{key:"render",value:function(){return s.a.createElement("div",{className:"footer"},s.a.createElement("p",null,"All rights reserved to Adar Abadian\u2122"))}}]),a}(n.Component)),I=(a(200),function e(t,a,n,s){Object(c.a)(this,e),this.firstName=t,this.lastName=a,this.userName=n,this.password=s}),M=(a(201),function(e){Object(d.a)(a,e);var t=Object(u.a)(a);function a(){return Object(c.a)(this,a),t.apply(this,arguments)}return a}(n.Component));M.validateField=function(e,t,a){return"tooShort"!==M.validateInput(e,t,a)&&("tooLong"!==M.validateInput(e,t,a)&&void 0)},M.validateInput=function(e,t,a){return e.length<t?(a.innerHTML="This Input Is Too Short &nbsp; &nbsp; Min Length Is "+t+" Characters  &#10060","tooShort"):e.length>12?(a.innerHTML="This Input Is Too Long &nbsp; &nbsp;Max Length Is 12 Characters  &#10060","tooLong"):(a.innerHTML="This Input Is Valid  &#9989;","valid")},M.isToDateBigger=function(e,t){return new Date(e)>new Date(t)?(V.b.warning("To date cant be later than from date!"),!1):!(new Date(e)<new Date)||(V.b.warning("From date is already passed!\nPlease fill a new one"),!1)};var L=function(e){Object(d.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).firstNameValidator=void 0,n.lastNameValidator=void 0,n.userNameValidator=void 0,n.passwordValidator=void 0,n.setFirstName=function(e){var t=e.target.value;n.setState({firstName:t}),n.isFirstNameValid(e.target)},n.setLastName=function(e){var t=e.target.value;n.setState({lastName:t}),n.isLastNameValid(e.target)},n.setUserName=function(e){var t=e.target.value;n.setState({userName:t}),n.isUserNameValid(e.target)},n.setPassword=function(e){var t=e.target.value;n.setState({password:t}),n.isPasswordValid(e.target)},n.isFirstNameValid=function(e){var t=n.firstNameValidator.current;if(!1===M.validateField(e.value,2,t))return e.className="invalidInput",n.setState({isFirstNameValid:!1}),!1;n.setState({isFirstNameValid:!0}),e.className="validInput"},n.isLastNameValid=function(e){var t=n.lastNameValidator.current;if(!1===M.validateField(e.value,2,t))return e.className="invalidInput",n.setState({isLastNameValid:!1}),!1;n.setState({isLastNameValid:!0}),e.className="validInput"},n.isUserNameValid=function(e){var t=n.userNameValidator.current;if(!1===M.validateField(e.value,3,t))return e.className="invalidInput",n.setState({isUserNameValid:!1}),!1;n.setState({isUserNameValid:!0}),e.className="validInput"},n.isPasswordValid=function(e){var t=n.passwordValidator.current;if(!1===M.validateField(e.value,6,t))return e.className="invalidInput",n.setState({isPasswordValid:!1}),!1;n.setState({isPasswordValid:!0}),e.className="validInput"},n.isUserNameExists=function(){var e=Object(h.a)(m.a.mark((function e(t){var a,s,r,i;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=t.target,e.prev=1,!((s={userName:n.state.userName}).userName.length>12||s.userName.length<3)){e.next=5;break}return e.abrupt("return");case 5:return e.next=7,E.a.post("https://adar-vacations.herokuapp.com/users/isUserNameExists",s);case 7:r=e.sent,i=r.data,a.className="validInput",n.userNameValidator.current.innerHTML="This username is free to use!  &#9989;",n.setState({isUserNameValid:!0}),V.b.success(i),e.next=23;break;case 15:e.prev=15,e.t0=e.catch(1),void 0===e.t0.response&&Object(V.b)(e.t0),a.className="invalidInput",n.userNameValidator.current.innerHTML=e.t0.response.data.error,n.setState({isUserNameValid:!1}),V.b.error(e.t0.response.data.error),console.log(e.t0);case 23:case"end":return e.stop()}}),e,null,[[1,15]])})));return function(t){return e.apply(this,arguments)}}(),n.registerNewUser=Object(h.a)(m.a.mark((function e(){var t,a,s;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!1!==n.areInputsValid()){e.next=3;break}return V.b.warn("OOPS \ud83d\ude28, looks like you didn't filled the details correctly."),e.abrupt("return");case 3:return e.prev=3,t=new I(n.state.firstName,n.state.lastName,n.state.userName,n.state.password),e.next=7,E.a.post("https://adar-vacations.herokuapp.com/users/register",t);case 7:return a=e.sent,s=a.data,e.next=11,S.saveUserDetailsOnSession(s);case 11:n.props.history.push("/vacationsboard"),V.b.success("Congratulations, Registered successfuly."),e.next=19;break;case 15:e.prev=15,e.t0=e.catch(3),V.b.error(e.t0.response.data.error),console.log(e.t0);case 19:case"end":return e.stop()}}),e,null,[[3,15]])}))),n.state={firstName:"",lastName:"",userName:"",password:"",isFirstNameValid:!1,isLastNameValid:!1,isUserNameValid:!1,isPasswordValid:!1},n.firstNameValidator=s.a.createRef(),n.lastNameValidator=s.a.createRef(),n.userNameValidator=s.a.createRef(),n.passwordValidator=s.a.createRef(),n}return Object(l.a)(a,[{key:"areInputsValid",value:function(){if(!1===this.state.isFirstNameValid||!1===this.state.isLastNameValid||!1===this.state.isPasswordValid||!1===this.state.isUserNameValid)return!1}},{key:"render",value:function(){var e=this;return s.a.createElement("div",{className:"entranceDiv"},s.a.createElement("h2",null,"Register"),s.a.createElement("form",{id:"form1",onSubmit:function(e){return e.preventDefault()}},s.a.createElement("table",null,s.a.createElement("tbody",null,s.a.createElement("tr",null,s.a.createElement("td",{className:"normalTableDivs"},"First Name: "),s.a.createElement("td",{className:"normalTableDivs"},s.a.createElement("input",{placeholder:"First Name",type:"text",id:"firstName",value:this.state.firstName,onChange:this.setFirstName}))),s.a.createElement("tr",{className:"validator",id:"firstNameValidator",ref:this.firstNameValidator}),s.a.createElement("tr",null,s.a.createElement("td",{className:"normalTableDivs"},"Last Name: "),s.a.createElement("td",{className:"normalTableDivs"},s.a.createElement("input",{placeholder:"Last Name",type:"text",id:"lastName",value:this.state.lastName,onChange:this.setLastName}))),s.a.createElement("tr",{className:"validator",id:"lastNameValidator",ref:this.lastNameValidator}),s.a.createElement("tr",null,s.a.createElement("td",{className:"normalTableDivs"},"Username: "),s.a.createElement("td",{className:"normalTableDivs"},s.a.createElement("input",{placeholder:"Username",type:"text",id:"userName",value:this.state.userName,onBlur:function(t){e.isUserNameExists(t)},onChange:this.setUserName}))),s.a.createElement("tr",{className:"validator",id:"userNameValidator",ref:this.userNameValidator}),s.a.createElement("tr",null,s.a.createElement("td",{className:"normalTableDivs"},"Password: "),s.a.createElement("td",{className:"normalTableDivs"},s.a.createElement("input",{placeholder:"Password",type:"password",id:"password",autoComplete:"on",value:this.state.password,onChange:this.setPassword}))),s.a.createElement("tr",{className:"validator",id:"passwordValidator",ref:this.passwordValidator})))),s.a.createElement(O.a,{onClick:this.registerNewUser,type:"submit",form:"form1",className:"button"},"Create Account!"),s.a.createElement("br",null),s.a.createElement("br",null),"Forgot that you have an account?",s.a.createElement("br",null),s.a.createElement(O.a,{component:D.b,to:"/",className:"button"},"Back To Login"))}}]),a}(n.Component),F=(a(202),a(320)),P=(a(203),a(130)),B=function(e){Object(d.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).handleClose=function(){b.dispatch({type:o.handleVacationEditModal,payload:[!1,!1]}),n.setState({isDatesCollapserOpen:!1}),n.props.hideModal()},n.setCollapserState=function(){var e,t=!Object(v.a)({},n.state).isDatesCollapserOpen;e=t?"Keep the original dates":"Change vacations dates",n.setState({isDatesCollapserOpen:t,collapserButtonText:e})},n.convertDateFormat=function(e){var t=e.split("/");return t[2]+"-"+t[1]+"-"+t[0]},n.changeDateFormat=function(e){var t=e.split("-");return t[2]+"/"+t[1]+"/"+t[0]},n.saveVacationChanges=Object(h.a)(m.a.mark((function e(){var t,a,s,r,i;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=Object(v.a)({},n.state),a=t.editedVacation,s=t.vacationToEdit,(r=new FormData).append("fileToDelete",s.picture),r.append("file",a.picture),n.state.isDatesCollapserOpen||(a.fromDate=n.convertDateFormat(s.fromDate),a.toDate=n.convertDateFormat(s.toDate)),!0===M.isToDateBigger(a.fromDate,a.toDate)){e.next=9;break}return e.abrupt("return");case 9:if(""!==a.fromDate&&""!==a.toDate){e.next=13;break}return V.b.warning("Please fill both dates!"),e.abrupt("return");case 13:if(a.picture===s.picture){e.next=18;break}return e.next=16,E.a.post("https://adar-vacations.herokuapp.com/vacations/upload",r,{});case 16:i=e.sent,a.picture=i.data.filename;case 18:return n.setState({isDatesCollapserOpen:!1}),e.prev=19,e.next=22,E.a.post("https://adar-vacations.herokuapp.com/vacations/editVacation/",a);case 22:V.b.success("Congratulations, The vacation was edited successfuly."),n.props.hideModal(),a.fromDate=n.changeDateFormat(a.fromDate),a.toDate=n.changeDateFormat(a.toDate),n.props.saveEditChanges(a),e.next=33;break;case 29:e.prev=29,e.t0=e.catch(19),V.b.error(e.t0.response.data.error),console.log(e.t0);case 33:case"end":return e.stop()}}),e,null,[[19,29]])}))),n.setFromDate=function(e){var t=Object(v.a)({},n.state.editedVacation);t.fromDate=e.target.value,n.setState({editedVacation:t})},n.setToDate=function(e){var t=Object(v.a)({},n.state.editedVacation);t.toDate=e.target.value,n.setState({editedVacation:t})},n.setPicture=function(e){var t=Object(v.a)({},n.state.editedVacation);t.picture=e.target.files[0],n.setState({editedVacation:t})},n.setDestination=function(e){var t=Object(v.a)({},n.state.editedVacation);t.destination=e.target.value,n.setState({editedVacation:t})},n.setDescription=function(e){var t=Object(v.a)({},n.state.editedVacation);t.description=e.target.value,n.setState({editedVacation:t})},n.setPrice=function(e){var t=Object(v.a)({},n.state.editedVacation);t.price=+e.target.value,n.setState({editedVacation:t})},n.state={vacationToEdit:b.getState().vacationToEdit,editedVacation:new g,isModalVisible:b.getState().isEditModalVisible,isDatesCollapserOpen:!1,collapserButtonText:"Change vacations dates"},n}return Object(l.a)(a,[{key:"componentDidMount",value:function(){this.setState({editedVacation:this.state.vacationToEdit})}},{key:"render",value:function(){return s.a.createElement("div",{className:"edit-modal"},s.a.createElement(F.a,{open:this.state.isModalVisible,onClose:this.handleClose},s.a.createElement("div",{id:"editModal"},s.a.createElement("h1",null,"Edit Vacation"),s.a.createElement("p",{className:"cardAddText"},"Photo address:",s.a.createElement("input",{type:"file",id:"picture",onChange:this.setPicture,placeholder:"URL"})),s.a.createElement("p",{className:"cardAddText"},"Destination:  ",s.a.createElement("input",{onChange:this.setDestination,id:"destination",type:"text",maxLength:30,value:this.state.editedVacation.destination,placeholder:"Destination"})),s.a.createElement("p",null,"Description: ",s.a.createElement("textarea",{onChange:this.setDescription,id:"description",value:this.state.editedVacation.description,className:"description",placeholder:"Description"})),s.a.createElement("div",{className:"smallInputsDiv"},s.a.createElement("div",{id:"dateSection"},s.a.createElement(O.a,{id:"collapserToggler",onClick:this.setCollapserState,className:"modalButtons"},this.state.collapserButtonText),s.a.createElement(P.Collapse,{isOpened:this.state.isDatesCollapserOpen},s.a.createElement("p",{className:"cardAddText"},"From Date: ",s.a.createElement("input",{onChange:this.setFromDate,id:"fromDate",className:"smallInputs",type:"date"})),s.a.createElement("p",{className:"cardAddText"},"To Date:  ",s.a.createElement("input",{onChange:this.setToDate,id:"toDate",className:"smallInputs",type:"date"})))),s.a.createElement("p",{className:"cardAddText"},s.a.createElement("span",{id:"priceOnModal"},"Price:"),s.a.createElement("input",{onChange:this.setPrice,id:"price",value:this.state.editedVacation.price,placeholder:"Price",className:"smallInputs",type:"number"})),s.a.createElement("div",{id:"buttonsDiv"},s.a.createElement(O.a,{className:"modalButtons",onClick:this.saveVacationChanges},"Save Vacation"),s.a.createElement(O.a,{className:"modalButtons",onClick:this.handleClose},"Cancel"))))))}}]),a}(n.Component),G=a(131),H=(a(205),a(206),function(e){Object(d.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).handleClose=function(){b.dispatch({type:o.handleNewVacationModal,payload:!1}),n.props.hideModal()},n.setFromDate=function(e){var t=Object(v.a)({},n.state.vacationToAdd);t.fromDate=e.target.value,n.setState({vacationToAdd:t})},n.setToDate=function(e){var t=Object(v.a)({},n.state.vacationToAdd);t.toDate=e.target.value,n.setState({vacationToAdd:t})},n.updateNewVacationPicture=function(e){var t=Object(v.a)({},n.state.vacationToAdd);t.picture=e.target.files[0],n.setState({vacationToAdd:t})},n.setDestination=function(e){var t=Object(v.a)({},n.state.vacationToAdd);t.destination=e.target.value,n.setState({vacationToAdd:t})},n.setDescription=function(e){var t=Object(v.a)({},n.state.vacationToAdd);t.description=e.target.value,n.setState({vacationToAdd:t})},n.setPrice=function(e){var t=Object(v.a)({},n.state.vacationToAdd);t.price=+e.target.value,n.setState({vacationToAdd:t})},n.addNewVacation=Object(h.a)(m.a.mark((function e(){var t,a,s,r;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("valid"===(t=n.isNewVacationValid())){e.next=4;break}return V.b.warning("Please Fill A Valid "+t+" Before Uploading!"),e.abrupt("return",!1);case 4:if(!0===M.isToDateBigger(n.state.vacationToAdd.fromDate,n.state.vacationToAdd.toDate)){e.next=6;break}return e.abrupt("return");case 6:return(a=new FormData).append("file",n.state.vacationToAdd.picture),e.prev=8,e.next=11,E.a.post("https://adar-vacations.herokuapp.com/vacations/upload",a,{});case 11:return s=e.sent,n.state.vacationToAdd.picture=s.data.filename,e.next=15,E.a.post("https://adar-vacations.herokuapp.com/vacations/addNewVacation/",n.state.vacationToAdd);case 15:r=e.sent,n.state.vacationToAdd.id=r.data,b.dispatch({type:o.handleNewVacationModal,payload:[n.state.vacationToAdd,!1]}),n.props.hideModal(),n.state.socket.emit("add-vacation",n.state.vacationToAdd),V.b.success("Congratulations, The vacation was added successfuly."),e.next=27;break;case 23:e.prev=23,e.t0=e.catch(8),V.b.error(e.t0.response.data.error),console.log(e.t0);case 27:case"end":return e.stop()}}),e,null,[[8,23]])}))),n.state={vacationToAdd:b.getState().vacationToAdd,isModalVisible:b.getState().isNewVacationModalVisible,socket:b.getState().socket},n}return Object(l.a)(a,[{key:"isNewVacationValid",value:function(){return""===this.state.vacationToAdd.picture.name?"Picture":this.state.vacationToAdd.destination.length<1?"Destination":this.state.vacationToAdd.description.length<1?"Description":""===this.state.vacationToAdd.fromDate?"From Date":""===this.state.vacationToAdd.toDate?"To Date":this.state.vacationToAdd.price<1?"Price":"valid"}},{key:"render",value:function(){return s.a.createElement("div",null,s.a.createElement(F.a,{open:this.state.isModalVisible,onClose:this.handleClose},s.a.createElement("div",{id:"editModal"},s.a.createElement("div",{className:"card",id:"addCard"},s.a.createElement("h2",{className:"headers"},"Add New Vacation"),s.a.createElement("div",{className:"card-body"},s.a.createElement("p",{className:"cardAddText"},"Photo address:",s.a.createElement("input",{type:"file",onChange:this.updateNewVacationPicture,placeholder:"URL"})),s.a.createElement("p",{className:"cardAddText"},"Destination:",s.a.createElement("input",{onChange:this.setDestination,type:"text",maxLength:30,value:this.state.vacationToAdd.destination,placeholder:"Destination"})),s.a.createElement("p",null,"Description: ",s.a.createElement("textarea",{onChange:this.setDescription,value:this.state.vacationToAdd.description,className:"description",placeholder:"Description"})),s.a.createElement("div",{className:"smallInputsDiv"},s.a.createElement("p",{className:"cardAddText"},"From Date: ",s.a.createElement("input",{onChange:this.setFromDate,value:this.state.vacationToAdd.fromDate,className:"smallInputs",type:"date"})),s.a.createElement("p",{className:"cardAddText"},"To Date:  ",s.a.createElement("input",{onChange:this.setToDate,value:this.state.vacationToAdd.toDate,className:"smallInputs",type:"date"})),s.a.createElement("p",{className:"cardAddText"},"Price:    ",s.a.createElement("input",{onChange:this.setPrice,value:this.state.vacationToAdd.price,placeholder:"Price",className:"smallInputs",type:"number"}))),s.a.createElement(O.a,{onClick:this.addNewVacation},"Add Vacation!"),s.a.createElement(O.a,{onClick:this.handleClose},"Cancel"))))))}}]),a}(n.Component)),R=a.p+"static/media/diagram.a38ee6b7.png",W=a.p+"static/media/new.45145c26.png",z=a(42),J=a(132),$=a(133);a(300),a(301);var q=function(e){var t,a={labels:[],datasets:[{label:"Vacation Followers \u2764",data:[]}]},n=Object(J.a)(e.props.props);try{for(n.s();!(t=n.n()).done;){var r=t.value;a.labels.push(r.destination),a.datasets[0].data.push(r.followersAmount)}}catch(i){n.e(i)}finally{n.f()}return s.a.createElement($.Bar,{data:a,options:{maintainAspectRatio:!0,plugins:{colorschemes:{scheme:"brewer.SetTwo5"}},scales:{yAxes:[{ticks:{beginAtZero:!0,stepSize:1,min:0}}]}},width:800,height:500})},K=function(e){Object(d.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).handleClose=function(){b.dispatch({type:o.handleAdminGraphVisibility,payload:!1}),n.props.hideModal()},n.state={isGraphVisible:b.getState().isAdminGraphVisible},n}return Object(l.a)(a,[{key:"componentDidMount",value:function(){this.setState({isGraphVisible:b.getState().isAdminGraphVisible})}},{key:"render",value:function(){return s.a.createElement(z.a,{animation:!1,show:this.state.isGraphVisible,onHide:this.handleClose,backdrop:"static",keyboard:!1},s.a.createElement(z.a.Header,{closeButton:!0},s.a.createElement(z.a.Title,null,"Vacations Graph")),s.a.createElement(z.a.Body,null,s.a.createElement("div",{className:"bar-chart"},s.a.createElement(q,{props:this.props}))),s.a.createElement(z.a.Footer,{className:"modal-footer"}))}}]),a}(n.Component),Y=function(e){Object(d.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).unsubscribeStore=void 0,n.componentDidUpdate=function(){b.getState().isUserLoggedIn||n.props.history.push("/"),"ADMIN"!==b.getState().userType&&n.props.history.push("/vacationsBoard")},n.setSocketListeners=function(){n.state.socket.on("increase-vacation-likes",(function(e){var t=n.getIndexFromVacations(e),a=n.state.vacations;a[t].followersAmount=a[t].followersAmount+1,n.setState({vacations:a})})),n.state.socket.on("decrease-vacation-likes",(function(e){var t=n.getIndexFromVacations(e),a=n.state.vacations;a[t].followersAmount=a[t].followersAmount-1,n.setState({vacations:a})})),n.state.socket.on("add-vacation",(function(e){e.fromDate=n.changeDateFormat(e.fromDate),e.toDate=n.changeDateFormat(e.toDate);var t=n.state.vacations;t.push(e),n.setState({vacations:t})}))},n.changeHistory=Object(h.a)(m.a.mark((function e(){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n.state.isUserLoggedIn||n.props.history.push("/");case 1:case"end":return e.stop()}}),e)}))),n.getIndexFromVacations=function(e){return n.state.vacations.findIndex((function(t){return t.id===e}))},n.hideEditModal=function(){b.dispatch({type:o.handleVacationEditModal,payload:[!1,!1]}),n.setState({isEditModalVisible:!1})},n.hideNewVacationModal=function(){n.setState({isNewVacationModalVisible:!1})},n.hideAdminGraphModal=function(){n.setState({isAdminGraphVisible:!1})},n.saveEditChanges=function(e){var t=n.state.vacations;t=t.map((function(t){return t.id===e.id?e:t})),n.setState({vacations:t}),n.state.socket.emit("update-vacation",e)},n.promptDeleteDialog=function(e){Object(G.confirmAlert)({title:"Confirm to submit",message:"Are you sure to delete the vacation to "+e.destination,buttons:[{label:"Yes",onClick:function(){return n.deleteVacation(e)}},{label:"No",onClick:function(){}}]})},n.changeDateFormat=function(e){var t=e.split("-");return t[2]+"/"+t[1]+"/"+t[0]},n.deleteVacation=function(){var e=Object(h.a)(m.a.mark((function e(t){var a,s;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,E.a.post("https://adar-vacations.herokuapp.com/vacations/deleteVacation/"+t.id);case 3:a=n.state.vacations,s=a.indexOf(t),a.splice(s,1),n.setState({vacations:a}),n.state.socket.emit("delete-vacation",t.id),V.b.success("The vacation was deleted successfuly."),e.next=15;break;case 11:e.prev=11,e.t0=e.catch(0),V.b.error(e.t0.response.data.error),console.log(e.t0);case 15:case"end":return e.stop()}}),e,null,[[0,11]])})));return function(t){return e.apply(this,arguments)}}(),n.state={vacations:new Array,newVacation:b.getState().vacationToAdd,isEditModalVisible:b.getState().isEditModalVisible,isUserLoggedIn:b.getState().isUserLoggedIn,userType:b.getState().userType,isNewVacationModalVisible:b.getState().isNewVacationModalVisible,socket:b.getState().socket,isAdminGraphVisible:b.getState().isAdminGraphVisible},n}return Object(l.a)(a,[{key:"componentDidMount",value:function(){var e=Object(h.a)(m.a.mark((function e(){var t,a=this;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!0===b.getState().isUserLoggedIn){e.next=7;break}return e.next=3,S.handleUnloggedUser();case 3:if("exit"!==e.sent){e.next=7;break}return this.props.history.push("/"),e.abrupt("return");case 7:return e.next=9,A();case 9:t=e.sent,this.setState({vacations:t}),this.setState({socket:b.getState().socket}),this.unsubscribeStore=b.subscribe((function(){return a.setState({isUserLoggedIn:b.getState().isUserLoggedIn,userType:b.getState().userType,newVacation:b.getState().vacationToAdd,isEditModalVisible:b.getState().isEditModalVisible,isNewVacationModalVisible:b.getState().isNewVacationModalVisible,isAdminGraphVisible:b.getState().isAdminGraphVisible},(function(){a.changeHistory()}))})),this.setSocketListeners();case 14:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"componentWillUnmount",value:function(){this.unsubscribeStore()}},{key:"openEditVacationModal",value:function(e){b.dispatch({type:o.handleVacationEditModal,payload:[e,!0]}),this.setState({isEditModalVisible:!0})}},{key:"openNewVacationModal",value:function(){b.dispatch({type:o.handleNewVacationModal,payload:[new g(0,"","",new File([""],""),"","",0,!1,0),!0]}),this.setState({isNewVacationModalVisible:!0})}},{key:"openAdminGraphModal",value:function(){b.dispatch({type:o.handleAdminGraphVisibility,payload:!0}),this.setState({isAdminGraphVisible:!0})}},{key:"render",value:function(){var e=this;return s.a.createElement("div",{id:"allVacationsBoard",className:"scrollbar scrollbar-morpheus-den"},s.a.createElement("h1",{className:"headers"},"Manage Vacations"),s.a.createElement("div",null,this.state.vacations.map((function(t,a){return s.a.createElement("div",{key:a,className:"card"},s.a.createElement("img",{className:"card-img-top",src:t.picture.toString(),alt:"../../UndefinedPictures/defaultPicture.jpg"}),s.a.createElement("div",{className:"card-body"},s.a.createElement("h5",{className:"card-title"},t.destination),s.a.createElement("p",{className:"desc"},t.description),s.a.createElement("p",{className:"card-text"},s.a.createElement("b",null,"From Date: "),t.fromDate),s.a.createElement("p",{className:"card-text"},s.a.createElement("b",null,"To Date: "),t.toDate),s.a.createElement("h5",{className:"card-title"},t.price,"$"),s.a.createElement("div",{className:"cardIcons"},s.a.createElement("span",{className:"material-icons",onClick:function(){e.promptDeleteDialog(t)}},"delete_forever"),s.a.createElement("span",{className:"material-icons",onClick:function(){e.openEditVacationModal(t)}},"build"),s.a.createElement("span",{className:"followersAmount",id:JSON.stringify(t.id)},"\u2665 ",t.followersAmount))))}))),s.a.createElement("div",{id:"adminButtonsDiv"},s.a.createElement(O.a,{onClick:function(){e.openAdminGraphModal()}},"Show Graph ",s.a.createElement("img",{src:R,alt:""})),s.a.createElement(O.a,{onClick:function(){e.openNewVacationModal()}},"New Vacation",s.a.createElement("img",{src:W,alt:""}))),!0===this.state.isEditModalVisible&&s.a.createElement(B,{hideModal:this.hideEditModal,saveEditChanges:this.saveEditChanges}),!0===this.state.isNewVacationModalVisible&&s.a.createElement(H,{hideModal:this.hideNewVacationModal}),!0===this.state.isAdminGraphVisible&&s.a.createElement(K,{props:this.state.vacations,hideModal:this.hideAdminGraphModal}))}}]),a}(n.Component),Z=function(){return b.getState().isUserLoggedIn},_=function(e){return Z()?s.a.createElement(U.b,{path:e.path,exact:e.exact,component:e.component}):s.a.createElement(U.a,{to:"/"})},Q=function(e){Object(d.a)(a,e);var t=Object(u.a)(a);function a(){return Object(c.a)(this,a),t.apply(this,arguments)}return Object(l.a)(a,[{key:"render",value:function(){return s.a.createElement("div",{id:"layout"},s.a.createElement(y,null),s.a.createElement("div",{id:"mainDiv"},s.a.createElement(D.a,null,s.a.createElement(U.d,null,s.a.createElement(U.b,{path:"/",component:T,exact:!0}),s.a.createElement(U.b,{path:"/register",component:L,exact:!0}),s.a.createElement(_,{path:"/vacationsboard",component:C,exact:!0}),s.a.createElement(_,{path:"/admin",component:Y,exact:!0})))),s.a.createElement(j,null))}}]),a}(n.Component);i.a.render(s.a.createElement(s.a.StrictMode,null,s.a.createElement(V.a,{position:"top-center"}),s.a.createElement(Q,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[303,1,2]]]);
//# sourceMappingURL=main.7d0966d9.chunk.js.map